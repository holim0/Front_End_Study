<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>Asynchronous JavaScript</title>
    </head>
    <body>
        <h1>Asynchronous JavaScript</h1>
        <script>
            // const second = () => {
            //     setTimeout(() => {
            //         console.log("async");
            //     }, 2000);
            // };

            // const first = () => {
            //     console.log("hello");
            //     second();
            //     console.log("end");
            // };

            // first();

            // function getRecipe() {
            //     setTimeout(() => {
            //         const recipeID = [123, 532, 324, 2445];
            //         console.log(recipeID); /// 서버에서 1.5초 후 가지고 오는걸 시뮬레이션

            //         setTimeout(
            //             (id) => {
            //                 const recipe = {
            //                     title: "pasta",
            //                     publisher: "heeje",
            //                 };
            //                 console.log(`${id} : ${recipe.title}`);

            //                 setTimeout(
            //                     (publisher) => {
            //                         const recipe = {
            //                             title: "pizza",
            //                             publisher: "heeje",
            //                         };
            //                         console.log(recipe);
            //                     },
            //                     1500,
            //                     recipe.publisher
            //                 );
            //             },
            //             1000,
            //             recipeID[2]
            //         ); // 3번째 parameter에 인자를 전달해준다.
            //     }, 1500);
            // }

            // getRecipe();

            // const getIDs = new Promise((resolve, reject) => {
            //     // resolve, reject 2개의 인자를 가진다.
            //     setTimeout(() => {
            //         resolve([123, 532, 324, 2445]); /// 성공하면 배열을 리턴한다.
            //     }, 1500);
            // });

            // const getRecipe = (recID) => {
            //     return new Promise((resolve, reject) => {
            //         setTimeout(
            //             (ID) => {
            //                 const recipe = {
            //                     title: "pasta",
            //                     publisher: "heeje",
            //                 };
            //                 resolve(recipe);
            //             },
            //             1500,
            //             recID
            //         );
            //     });
            // };

            // const getLelated = (publisher) => {
            //     return new Promise((resolve, reject) => {
            //         setTimeout(
            //             (publisher) => {
            //                 const recipe = {
            //                     title: "pizza",
            //                     publisher: "heeje",
            //                 };
            //                 resolve(`${publisher} : ${recipe.title}`);
            //             },
            //             1500,
            //             publisher
            //         );
            //     });
            // };

            // getIDs
            //     .then((IDs) => {
            //         // IDs 에 배열이 전달된다.
            //         console.log(IDs);
            //         return getRecipe(IDs[2]); // 다음 then 에 전달 해줄 수 있다.
            //     })
            //     .then((recipe) => {
            //         // .then 을 써서 chaining 이 가능하다.
            //         console.log(recipe);
            //         return getLelated(recipe.publisher);
            //     })
            //     .then((recipe) => {
            //         console.log(recipe);
            //     })
            //     .catch((error) => {
            //         // reject 됐을 때
            //         console.log("Error!");
            //     });

            // async function getRecipesAw() {
            //     // runs in background
            //     const IDs = await getIDs; // getIDs 에서 충족되면 들고 온다. (resolve 가 return 한 값)
            //     console.log(IDs);

            //     const recipe = await getRecipe(IDs[2]);
            //     console.log(recipe);

            //     const related = await getLelated(recipe.publisher);
            //     console.log(related);

            //     return recipe; //Promise return
            // }

            // getRecipesAw().then((result) => {
            //     console.log(`hihi ${result}`);
            // });
            // console.log(rec);    // 함수가 백그라운드에서 실행되고 있고 아직 return 값이 없기 때문에 아무런 값이 뜨지 않는다.

            // function getID(name) {
            //     fetch(`https://api.github.com/users/${name}`)
            //         .then((result) => {
            //             console.log(result);
            //             return result.json();
            //         })
            //         .then((data) => {
            //             console.log(data);

            //             const log = data.id;
            //             console.log(log);
            //         })
            //         .catch((error) => {
            //             console.log(error);
            //         });
            // }

            // getID("iliakan");
            // getID("remy");

            async function getIDaw(name) {
                try {
                    const result = await fetch(
                        `https://api.github.com/users/${name}`
                    );

                    const data = await result.json();
                    console.log(data);

                    console.log(data.id);
                } catch (error) {
                    console.log(error);
                }
            }

            getIDaw("iliakan");
            getIDaw("remy");
        </script>
    </body>
</html>
